{"version":3,"file":"cart.js","mappings":"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","sources":["webpack://itay-upsell-and-cart-plugin/./src/user/js/cart.js"],"sourcesContent":["class Cart {\r\n  #form;\r\n  #datePicker;\r\n  #timePicker;\r\n  #userTime;\r\n  #siteTimes;\r\n  #todaySelected;\r\n  #instantiated;\r\n  #data = {\r\n    date: undefined,\r\n    time: undefined,\r\n  };\r\n  constructor() {\r\n    jQuery(document).ajaxStop(() => {\r\n      if (this.#instantiated) return;\r\n      this.#instantiated = true;\r\n      this.initializeVariables();\r\n      console.log(\"hello\");\r\n      this.events();\r\n    });\r\n  }\r\n  events() {\r\n    // form submit\r\n    this.#form.on(\"submit\", (e) => {\r\n      e.preventDefault();\r\n      this.submitForm();\r\n    });\r\n\r\n    // Date change\r\n    this.#datePicker.datepicker(\r\n      \"option\",\r\n      \"onSelect\",\r\n      function (dateText, inst) {\r\n        // update the date property.\r\n        this.#data.date = new Date(dateText).getDate();\r\n        const currentDate = new Date().getDate();\r\n        this.#todaySelected = this.#data.date == currentDate ? true : false;\r\n        console.log(this.#todaySelected);\r\n        // show time selector.\r\n        this.showTimeSelector();\r\n      }.bind(this)\r\n    );\r\n\r\n    //Time selected\r\n    this.#timePicker.change(function () {\r\n      alert(\"changed\");\r\n    });\r\n  }\r\n\r\n  showTimeSelector() {\r\n    if (this.#timePicker.hasClass(\"hidden\")) {\r\n      this.#form.find(\"#arrival-time-label\").removeClass(\"hidden\");\r\n      this.#timePicker.removeClass(\"hidden\");\r\n    }\r\n    this.generateTimes();\r\n  }\r\n\r\n  generateTimes() {\r\n    this.#userTime = new Date().toLocaleTimeString(\"he-IL\", {\r\n      hour12: false,\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n    this.#timePicker[0].innerHTML = \"\";\r\n\r\n    for (const [start, end] of Object.entries(this.#siteTimes)) {\r\n      if (this.#todaySelected) {\r\n        if (this.#userTime < start) {\r\n          this.#timePicker[0].innerHTML += `<option>${start}:${end}</option>`;\r\n        }\r\n      } else {\r\n        this.#timePicker[0].innerHTML += `<option>${start}:${end}</option>`;\r\n      }\r\n    }\r\n  }\r\n  submitForm() {\r\n    //rendering a spinner\r\n    const url = this.#form.attr(\"data-url\");\r\n    const data = {};\r\n    const formData = [...new FormData(this.#form[0])];\r\n    formData.forEach((element) => {\r\n      data[element[0]] = element[1];\r\n    });\r\n    console.log(data);\r\n    this.renderSpinner();\r\n    jQuery.ajax({\r\n      type: \"POST\",\r\n      url: url,\r\n      data: data,\r\n      dataType: \"json\",\r\n      success: function (data, textStatus, jqXHR) {\r\n        //process data\r\n        console.log(data);\r\n        this.showCart();\r\n      }.bind(this),\r\n      error: function (data, textStatus, jqXHR) {\r\n        //process error msg\r\n        console.log(data);\r\n      },\r\n    });\r\n  }\r\n\r\n  showCart() {\r\n    jQuery(\".iucp-address-container, .xoo-wsc-body, .xoo-wsc-footer\").each(\r\n      function () {\r\n        jQuery(this).toggleClass(\"hidden\");\r\n      }\r\n    );\r\n  }\r\n\r\n  renderSpinner() {\r\n    this.#form[0].innerHTML = \"<div class='lds-dual-ring'></div>\";\r\n  }\r\n\r\n  initializeVariables() {\r\n    this.#siteTimes = iucpTimes;\r\n\r\n    this.#form = jQuery(\"#iucp_form\");\r\n\r\n    this.#datePicker = jQuery(\"#iucp_datepicker\").datepicker({\r\n      dateFormat: \"mm-dd-yy\",\r\n      minDate: 0,\r\n      beforeShowDay: (date) => {\r\n        return [\r\n          date.getDay() == 0 ||\r\n            date.getDay() == 1 ||\r\n            date.getDay() == 2 ||\r\n            date.getDay() == 3 ||\r\n            date.getDay() == 4 ||\r\n            date.getDay() == 5,\r\n        ];\r\n      },\r\n    });\r\n\r\n    this.#timePicker = jQuery(\"#iucp_address_arrival_time\");\r\n  }\r\n}\r\n\r\nconst iucpCart = new Cart();\r\n"],"names":["Cart","form","datePicker","timePicker","userTime","siteTimes","todaySelected","instantiated","data","date","undefined","time","constructor","jQuery","document","ajaxStop","initializeVariables","console","log","events","on","e","preventDefault","submitForm","datepicker","dateText","inst","Date","getDate","currentDate","showTimeSelector","bind","change","alert","hasClass","find","removeClass","generateTimes","toLocaleTimeString","hour12","hour","minute","innerHTML","start","end","Object","entries","url","attr","formData","FormData","forEach","element","renderSpinner","ajax","type","dataType","success","textStatus","jqXHR","showCart","error","each","toggleClass","iucpTimes","dateFormat","minDate","beforeShowDay","getDay","iucpCart"],"sourceRoot":""}